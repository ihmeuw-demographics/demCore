<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Calculate summary statistics for life tables — summarize_lt • demCore</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate summary statistics for life tables — summarize_lt"><meta property="og:description" content="Calculate summary statistics for life tables when collapsing
over a certain variable. For example can calculate summary statistics
across a set of draws, or locations, or location-years, etc."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">demCore</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/ccmpp.html">Cohort Component Method of Population Projection (CCMPP)</a>
    </li>
    <li>
      <a href="../articles/introduction_to_life_tables.html">Introduction to life tables</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/ihmeuw-demographics/demCore/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate summary statistics for life tables</h1>
    <small class="dont-index">Source: <a href="https://github.com/ihmeuw-demographics/demCore/blob/HEAD/R/summarize_lt.R" class="external-link"><code>R/summarize_lt.R</code></a></small>
    <div class="hidden name"><code>summarize_lt.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calculate summary statistics for life tables when collapsing
over a certain variable. For example can calculate summary statistics
across a set of draws, or locations, or location-years, etc.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">summarize_lt</span><span class="op">(</span></span>
<span>  <span class="va">dt</span>,</span>
<span>  <span class="va">id_cols</span>,</span>
<span>  <span class="va">summarize_cols</span>,</span>
<span>  <span class="va">value_cols</span>,</span>
<span>  summary_fun <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mean"</span><span class="op">)</span>,</span>
<span>  probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span>,</span>
<span>  recalculate_starting_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mx"</span>, <span class="st">"ax"</span><span class="op">)</span>,</span>
<span>  recalculate_stats <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mean"</span><span class="op">)</span>,</span>
<span>  preserve_u5 <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  assert_na <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  format_long <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>dt</dt>
<dd><p>[<code><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table()</a></code>]<br>
Life tables to calculate summary statistics for. Must include all
<code>id_cols</code>, <code>summarize_cols</code>, and <code>value_cols</code>.</p></dd>


<dt>id_cols</dt>
<dd><p>[<code><a href="https://rdrr.io/r/base/character.html" class="external-link">character()</a></code>]<br>
ID columns that uniquely identify each row of <code>dt</code>.</p></dd>


<dt>summarize_cols</dt>
<dd><p>[<code><a href="https://rdrr.io/r/base/character.html" class="external-link">character()</a></code>]<br>
The <code>id_cols</code> that should be collapsed and to calculate summary statistics
over.</p></dd>


<dt>value_cols</dt>
<dd><p>[<code><a href="https://rdrr.io/r/base/character.html" class="external-link">character()</a></code>]<br>
Value columns (life table parameters) that summary statistics should be
calculated for. Valid choices are 'mx', 'qx', 'ax,', 'dx', 'px', 'lx',
'Tx', 'nLx', &amp; 'ex'. Must include at least 2 of 'mx', 'qx', or 'ax'.</p></dd>


<dt>summary_fun</dt>
<dd><p>[<code><a href="https://rdrr.io/r/base/character.html" class="external-link">character()</a></code>]<br>
Names of the functions that can be used to summarize a vector of values.
Default is "mean".</p></dd>


<dt>probs</dt>
<dd><p>[<code><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric()</a></code>]<br>
Probabilities with values in <code>[0,1]</code> to be used when producing sample
quantiles with <code><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">stats::quantile()</a></code>. Default is 0.025 and 0.975 for the
2.5th and 97.5th quantiles. Can be NULL if no quantiles are needed.</p></dd>


<dt>recalculate_starting_params</dt>
<dd><p>[<code>character(2)</code>]<br>
2 of 'mx', 'qx', or 'ax' from which to recalculate certain summary
statistics (<code>recalculate_stats</code>) for all other <code>value_cols</code> using
<code><a href="lifetable.html">demCore::lifetable</a></code>.</p></dd>


<dt>recalculate_stats</dt>
<dd><p>[<code><a href="https://rdrr.io/r/base/character.html" class="external-link">character()</a></code>]<br>
The summary statistic to recalculate all life table parameters
corresponding to that statistic so that they are consistent with one
another. Uses <code><a href="lifetable.html">demCore::lifetable</a></code> to recalculate all life table parameters
and keeps the life table parameters specified in <code>value_cols</code>. Default is
'mean'.</p></dd>


<dt>preserve_u5</dt>
<dd><p>[<code><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical()</a></code>]<br>
Whether to preserve under-5 qx estimates rather than recalculating them
based on mx and ax.</p></dd>


<dt>assert_na</dt>
<dd><p>[<code><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical()</a></code>]<br> Whether to assert that there is no
missingness.</p></dd>


<dt>format_long</dt>
<dd><p>[<code>logical(1)</code>]<br>
Whether to format output with a 'life_table_parameter' column and a column
for each summary statistic (rather than a column for each
'life_table_parameter' and summary statistic pair).</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>[<code><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table()</a></code>] with <code>id_cols</code> (minus the <code>summarize_cols</code>) plus
summary statistic columns. The summary statistic columns have the same name
as each function specified in <code>summary_fun</code> and the quantiles are named
like 'q_<code>(probs * 100)</code>'. Each of the summary statistic columns that are
returned are prefixed with the value column name. If <code>format_long</code> then
output is returned with a 'life_table_parameter' column and a column for
each summary statistic.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>One example use case for <code>summarize_lt</code> is when we have multiple draws
(independent simulations) of life tables to propagate uncertainty. Each of
the independent draws of life tables may have all life table parameters. The
mean, 2.5th and 97.5 percentiles across all draws for all life table
parameters can be calculated. But the mean 'mx', 'qx', 'ax' parameters would
be inconsistent with the mean 'ex' parameter for example. This is when
specifying <code>recalculate_stats = 'mean'</code> would recalculate the mean 'ex'
parameter using the mean 'mx', 'qx', and/or 'ax' as inputs to the
<code><a href="lifetable.html">demCore::lifetable</a></code> function.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>demUtils::summarize_dt</p>
<p>demCore::lifetable</p>
<p>demCore::validate_lifetable</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"austria_1992_lt"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dt</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">for</span><span class="op">(</span><span class="va">d</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span> <span class="va">dt_new</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/copy.html" class="external-link">copy</a></span><span class="op">(</span><span class="va">austria_1992_lt</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">dt_new</span><span class="op">[</span>, <span class="va">draw</span> <span class="op">:=</span> <span class="va">d</span><span class="op">]</span></span></span>
<span class="r-in"><span> <span class="va">dt_new</span><span class="op">[</span>, <span class="va">mx</span> <span class="op">:=</span> <span class="va">mx</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span>, mean <span class="op">=</span> <span class="fl">1</span>, sd <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span> <span class="va">dt_new</span><span class="op">[</span>, <span class="va">ax</span> <span class="op">:=</span> <span class="va">ax</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span>, mean <span class="op">=</span> <span class="fl">1</span>, sd <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span> <span class="va">dt_new</span><span class="op">[</span>, <span class="va">qx</span> <span class="op">:=</span> <span class="cn">NULL</span><span class="op">]</span></span></span>
<span class="r-in"><span> <span class="va">dt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">dt</span>, <span class="va">dt_new</span>, fill <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="va">dt</span> <span class="op">&lt;-</span> <span class="va">dt</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">age_start</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">dt</span> <span class="op">&lt;-</span> <span class="va">dt</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">age_start</span>, <span class="va">age_end</span>, <span class="va">draw</span>, <span class="va">mx</span>, <span class="va">ax</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">dt</span> <span class="op">&lt;-</span> <span class="fu">summarize_lt</span><span class="op">(</span></span></span>
<span class="r-in"><span>  dt <span class="op">=</span> <span class="va">dt</span>,</span></span>
<span class="r-in"><span>  id_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"age_start"</span>, <span class="st">"age_end"</span>, <span class="st">"draw"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  summarize_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"draw"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  value_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mx"</span>, <span class="st">"ax"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  recalculate_stats <span class="op">=</span> <span class="st">"mean"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Katie Paulson, Grant Nguyen, Charlton Callender, Spencer Pease, Haidong Wang, Institute for Health Metrics and Evaluation.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

